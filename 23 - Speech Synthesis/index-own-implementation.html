<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Text To Speech</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      .box {
        display: flex;
        flex-direction: column;
        margin-left: auto;
        margin-right: auto;
        background-color: rgb(211, 216, 216);
      }
      .box > * {
        flex-grow: 1;
      }
      .heading {
        width: auto;
        margin: auto;
      }
    </style>
  </head>
  <body>
    <div class="box">
      <h1 class="heading">The Voiceinator 5000</h1>

      <select name="voice" id="voices">
        <option value="Google US English">Google US English (en-US)</option>
        <!--<option value="Google UK English Female">
          Google UK English Female (en-GB)
        </option>
        <option value="Google UK English Male">
          Google UK English Male (en-GB)
        </option>
        -->
      </select>
      <label for="rate">Rate:</label>
      <input type="range" name="rate" min="0" max="3" value="1" step="0.1" />

      <label for="pitch">Pitch:</label>
      <input type="range" name="pitch" min="0" max="2" step="0.1" />

      <textarea name="text">Hello! I love Javascript üëç</textarea>

      <button id="stop">Stop!</button>
      <button id="speak">Speak</button>
    </div>
  </body>

  <script>
    const start = document.getElementById("speak");
    const stop = document.getElementById("stop");

    const voice_list = document.getElementById("voices");
    const rate = document.querySelector(`input[name="rate"]`);
    const pitch = document.querySelector(`input[name="pitch"]`);

    start.addEventListener("click", startAudio);
    stop.addEventListener("click", stopAudio);

    var voices = [];

    // function startAudio(e) {
    //   console.log("Speech start button pressed");
    //   console.log(e);
    // }

    function stopAudio(e) {
      console.log("Speech audio stop button pressed");
      console.log(e);
      synth.cancel();
    }

    var synth = window.speechSynthesis;
    var text = document.querySelector("textarea");
    // console.log(text.innerHTML);
    // Web api Speech Synthesis is awesone.
    // console.log(synth.getVoices());
    var utterThis = new SpeechSynthesisUtterance(text.value);

    function startAudio(e) {
      console.log("Audio should start");
      //   event.preventDefault();

      //   console.log(text.value);
      utterThis = new SpeechSynthesisUtterance(text.value);
      utterThis.pitch = pitch.value;
      utterThis.rate = rate.value;

      console.log(voice_list.value);
      // console.log(speechSynthesis.getVoices());

      synth.speak(utterThis);
      console.log(utterThis.voice);
      // console.log(utterThis.pitch);
      // console.log(utterThis.rate);
      createVoiceList();
    }

    function createVoiceList() {
      voices = synth.getVoices();
      // console.log(voices);
      let i = 0;
      voices.forEach((a) => {
        // console.log(a);
        voice_list.innerHTML += `<option data-name="${a.name}" data-lang="${a.lang}">${a.name} ( ${a.lang} )</option>`;
      });
      //console.log(voice_list);
    }
    createVoiceList();

    // var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition
    // var SpeechGrammarList = SpeechGrammarList || webkitSpeechGrammarList
    // var SpeechRecognitionEvent = SpeechRecognitionEvent || webkitSpeechRecognitionEvent
    // // console.log(SpeechRecognition);
    // // var SpeechRecognition = SpeechRecognition;
    // var recognition = new SpeechRecognition();
    // var SpeechRecognitionList = new SpeechGrammarList();

    // console.log(recognition);
    // console.log(SpeechRecognitionList);
  </script>
</html>
